[PARSER]
    Name        syslog-rfc5424
    Format      regex
    Regex       ^\<(?<pri>[0-9]{1,5})\>1 (?<time>[^ ]+) (?<host>[^ ]+) (?<ident>[^ ]+) (?<pid>[-0-9]+) (?<msgid>[^ ]+) (?<extradata>(\[(.*)\]|-)) (?<message>.+)$
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On
    Types pid:integer

[PARSER]
    Name        syno_syslog
    Format      regex
    # Capture a timestamp with optional fraction and timezone offset
    Regex       ^<(?<pri>\d+)>\d+\s+(?<time>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(?:\.\d+)?[+\-]\d{2}:\d{2}\s+(?<host>\S+)\s+(?<msg>.*)$
    Time_Key    time
    # Parse only the YYYY-MM-DDThh:mm:ss part (drops offset)
    Time_Format %Y-%m-%dT%H:%M:%S

    
[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On